<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Getting started &#8212; i-PI 3.0.0-alpha2 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/agogo.css?v=3ace793a" />
    <link rel="stylesheet" type="text/css" href="_static/custom_styles.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=a69af3ce"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Internal units and conventions" href="units.html" />
    <link rel="prev" title="Core features" href="features.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
          <p class="logo"><a href="index.html">
            <img class="logo" src="_static/ipi-logo.svg" alt="Logo"/>
          </a></p>
        <div class="headertitle"><a
          href="index.html">i-PI 3.0.0-alpha2 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="features.html" title="Core features"
             accesskey="P">previous</a> |
          <a href="units.html" title="Internal units and conventions"
             accesskey="N">next</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="sidebar">
          
          <h3>Table of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Core features</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installing-i-pi">Installing i-PI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-clients">Installing clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-i-pi">Running i-PI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-the-install">Testing the install</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Internal units and conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-files.html">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-tags.html">Input file tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="output-files.html">Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="output-tags.html">Output file tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributed.html">Distributed execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">A simple tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
            </form>
          </div>

        </div>
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this heading">¶</a></h1>
<section id="installing-i-pi">
<span id="install"></span><h2>Installing i-PI<a class="headerlink" href="#installing-i-pi" title="Permalink to this heading">¶</a></h2>
<section id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this heading">¶</a></h3>
<p>i-PI is Python code, and as such strictly speaking does not need to be
compiled and installed. The <code class="docutils literal notranslate"><span class="pre">i-pi</span></code> file in the <code class="docutils literal notranslate"><span class="pre">bin</span></code> directory of
the distribution is the main (executable) script, and can be run as long
as the system has installed:</p>
<ul class="simple">
<li><p>Python version 3.6 or greater (starting from version 2.0, i-PI is not Python2
compatible)</p></li>
<li><p>The Python numerical library NumPy</p></li>
</ul>
<p>See <a class="reference internal" href="#runningsimulations"><span class="std std-ref">Running i-PI</span></a> for more details on how to launch i-PI.</p>
<p>Additionally, most client codes will have their own requirements. Many
of them, including the test client codes given in the “drivers”
directory, will need a suitable Fortran compiler. A C compiler is
required for the sockets.c wrapper to the sockets standard library. Most
electronic structure codes will also need to be linked with some
mathematical libraries, such as BLAS, FFTW and LAPACK. Installation
instructions for these codes should be provided as part of the code
distribution and on the appropriate website, as given in
<a class="reference internal" href="introduction.html#librarywebsites"><span class="std std-ref">Client code resources</span></a>. Patching for use with i-PI should not
introduce further dependencies.</p>
<section id="using-the-setup-py-module">
<h4>Using the setup.py module<a class="headerlink" href="#using-the-setup-py-module" title="Permalink to this heading">¶</a></h4>
<p>While the <code class="docutils literal notranslate"><span class="pre">i-pi</span></code> file can be used to run any i-PI simulation, it is
often more convenient to install the package to the system’s Python
modules path, so that it is accessible by all users and can be run
without specifying the path to the Python script.</p>
<p>For this purpose we have included a module in the root directory of the
i-PI distribution, <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>, which handles creating a package with
the executable and all the modules which are necessary for it to run.
The first step is to build the distribution using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">build</span>
</pre></div>
</div>
<p>Note that this requires the distutils package that comes with the
python-dev package.</p>
<p>This creates a “build” directory containing only the files that are used
to run an i-PI simulation, which can then be used to create the
executable. This can be done in two ways, depending on whether or not
the user has root access. If the user does have root access, then the
following command will add the relevant source files to the standard
Python library directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<p>This will install the package in the /usr/lib/py_vers directory, where
py_vers is the version of Python that is being used. This requires
administrator priviledges.</p>
<p>Otherwise, one can install i-PI in a local Python path. If such path
does not exist yet, one must create directories for the package to go
into, using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">mkdir</span> <span class="o">~/</span><span class="nb">bin</span>
<span class="o">&gt;</span> <span class="n">mkdir</span> <span class="o">~/</span><span class="n">lib</span><span class="o">/</span><span class="n">py_vers</span>
<span class="o">&gt;</span> <span class="n">mkdir</span> <span class="o">~/</span><span class="n">lib</span><span class="o">/</span><span class="n">py_vers</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span>
</pre></div>
</div>
<p>Next, you must tell Python where to find this library, by appending to
the Linux environment variable PYTHONPATH, using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export PYTHONPATH=$PYTHONPATH:~/lib/py_vers/site-packages/
</pre></div>
</div>
<p>Finally, the code can be installed using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; python setup.py install –prefix=
</pre></div>
</div>
<p>Either way, it will now be possible to run the code automatically, using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">i</span><span class="o">-</span><span class="n">pi</span> <span class="nb">input</span><span class="o">-</span><span class="n">file</span><span class="o">.</span><span class="n">xml</span>
</pre></div>
</div>
</section>
</section>
<section id="i-pi-download">
<h3>i-PI download<a class="headerlink" href="#i-pi-download" title="Permalink to this heading">¶</a></h3>
<p>You can find information how to download i-PI from
<a class="reference external" href="http://ipi-code.org/download/">http://ipi-code.org/download/</a>.</p>
<p>The i-PI executable, found in the <code class="docutils literal notranslate"><span class="pre">bin</span></code> folder, will run immediately,
without needing to be installed or compiled, but we include a setup.py
module in the main directory so it can be installed to the Python tree
if so desired.</p>
</section>
<section id="installing-numpy">
<h3>Installing NumPy<a class="headerlink" href="#installing-numpy" title="Permalink to this heading">¶</a></h3>
<p>NumPy is the standard Python mathematics library, and is used for most
of the array manipulation and linear algebra in i-PI. It should be
installed alongside most standard Python environments on HPC facilities.
Otherwise, it is generally relatively straightforward to install it.</p>
<p>In any case you must first obtain the NumPy code, which can be
downloaded as a tar file from <a class="reference external" href="http://www.numpy.org">http://www.numpy.org</a>. If the version of
NumPy being installed is given by “np_vers”, this can be extracted
using:</p>
<p>Before installing this code it first needs to be configured correctly.
Note that this requires the distutils package that comes with the
python-dev package. Assuming that the required software is installed,
the NumPy package is built using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">build</span>
</pre></div>
</div>
<p>The next step is to install NumPy. By default the download is to the
directory /usr/local. If you have root access, and so can write to /usr,
then all that needs to be done to finish the install is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<p>If you do not have root access, then the next step depends on which
version of Python is beind used. With versions 2.6 or later there is a
simple command to automatically download into the directory $HOME/local:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; python setup.py install –user
</pre></div>
</div>
<p>With Python 2.4/2.5 the process is a little more involved. First you
must explicitly install the package in the directory of choice, “np_dir”
say, with the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span> <span class="o">--</span><span class="n">prefix</span><span class="o">=</span><span class="n">np_dir</span>
</pre></div>
</div>
<p>Next, you must tell Python where to find this library, by appending to
the Linux environment variable PYTHONPATH. If you are using Python
version “py_vers”, then the NumPy libraries will have been installed in
the directory “np_dir/lib/py_vers/site-packages”, or a close analogue of
this. In the above case the following command will allow the Python
interpreter to find the NumPy libraries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; export PYTHONPATH=$PYTHONPATH:np_dir/lib/py_vers/site-packages
</pre></div>
</div>
<p>Now Python scripts can import the NumPy libraries using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
</pre></div>
</div>
</section>
<section id="pyfftw">
<h3>PyFFTW<a class="headerlink" href="#pyfftw" title="Permalink to this heading">¶</a></h3>
<p>Some of the steps in the dynamics algorithm involve a change of
variables from the bead coordinates to the normal modes of the ring
polymers. Currently, this transformation is, at least by default,
computed using a fast-Fourier transform (FFT) library within the NumPy
distribution. This however is not the only distribution that could be
used, and indeed faster stand-alone versions exist. The gold-standard
FFT library is the FFTW library, which is a set of C libraries that have
been heavily optimized for a wide range of applications. There have been
a number of Python wrappers built around the FFTW library, one of which
is currently interfaced with i-PI. This code can be found at
<a class="reference external" href="https://github.com/hgomersall/pyFFTW">https://github.com/hgomersall/pyFFTW</a>, and has documentation at
<a class="reference external" href="http://hgomersall.github.io/pyFFTW/">http://hgomersall.github.io/pyFFTW/</a>.</p>
<p>This code has the following dependencies:</p>
<ul class="simple">
<li><p>Python version 2.7 or greater</p></li>
<li><p>Numpy version 1.6 or greater</p></li>
<li><p>FFTW version 3.2 or greater</p></li>
</ul>
<p>This can be installed in the same way as NumPy, except using the code
distribution above, or using various installation packages as per the
instructions on the above documentation. Note that no other options need
to be specified in the input file; i-PI will check to see if this
library is available, and if it is it will be used by default. Otherwise
the slower NumPy version will be used.</p>
</section>
</section>
<section id="installing-clients">
<span id="clientinstall"></span><h2>Installing clients<a class="headerlink" href="#installing-clients" title="Permalink to this heading">¶</a></h2>
<p>As of today, the following codes provide out-of-the-box an i-PI
interface: CP2K, DFTB+, Lammps, Quantum ESPRESSO, Siesta, FHI-aims,
Yaff, deMonNano, TBE. Links to the webpages of these codes, including
information on how to obtain them, can be found in <a class="reference external" href="http://ipi-code.org/">http://ipi-code.org/</a>.</p>
<p>If you are interested in interfacing your code to i-PI please get in
touch, we are always glad to help. We keep some information below in
case you are interested in writing a patch to a code.</p>
<section id="writing-a-patch">
<h3>Writing a patch<a class="headerlink" href="#writing-a-patch" title="Permalink to this heading">¶</a></h3>
<p>If you have edited a client code, and wish to make a patch available for
the new version, then this can be done very simply. If your edited code
is in a directory “new”, and a clean distribution is held in a directory
“old”, then a patch “changes.patch” can be created using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">diff</span> <span class="o">-</span><span class="n">rupN</span> <span class="n">old</span><span class="o">/</span> <span class="n">new</span><span class="o">/</span> <span class="o">&gt;</span> <span class="n">changes</span><span class="o">.</span><span class="n">patch</span>
</pre></div>
</div>
</section>
</section>
<section id="running-i-pi">
<span id="runningsimulations"></span><h2>Running i-PI<a class="headerlink" href="#running-i-pi" title="Permalink to this heading">¶</a></h2>
<p>i-PI functions based on a client-server protocol, where the evolution of
the nuclear dynamics is performed by the i-PI server, whereas the energy
and forces evaluation is delegated to one or more instances of an
external program, that acts as a client. This design principle has
several advantages, in particular the possibility of performing PIMD
based on the forces produced by one’s favourite electronic
structure/empirical force field code. However, it also makes running a
simulation slightly more complicated, since the two components must be
set up and started independently.</p>
<section id="running-the-i-pi-server">
<h3>Running the i-PI server<a class="headerlink" href="#running-the-i-pi-server" title="Permalink to this heading">¶</a></h3>
<p>i-PI simulations are run using the i-pi Python script found in the
“i-pi” directory. This script takes an xml-formatted file as input, and
automatically starts a simulation as specified by the data held in it.
If the input file is called “input_file.xml”, then i-PI is run using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python</span> <span class="n">i</span><span class="o">-</span><span class="n">pi</span> <span class="n">input_file</span><span class="o">.</span><span class="n">xml</span>
</pre></div>
</div>
<p>This reads in the input data, initializes all the internally used
objects, and then creates the server socket. The code will then wait
until at least one client code has connected to the server before
running any dynamics. Note that until this has happened the code is
essentially idle, the only action that it performs is to periodically
poll for incoming connections.</p>
</section>
<section id="running-the-client-code">
<span id="runningclients"></span><h3>Running the client code<a class="headerlink" href="#running-the-client-code" title="Permalink to this heading">¶</a></h3>
<p>Below we give examples on how to make different clients communicate with
i-PI. Most clients also include descriptions on how to do this from
their own documentation.</p>
<section id="built-in-example-client">
<span id="driver-x"></span><h4>Built-in, example client<a class="headerlink" href="#built-in-example-client" title="Permalink to this heading">¶</a></h4>
<p>While i-PI is designed with <em>ab initio</em> electronic structure
calculations in mind, it also includes a Fortran empirical potential
client code to do simple calculations and to run the examples.</p>
<p>The source code for this is included in the directory “drivers”, and can
be compiled into an executable “i-pi-driver” using the UNIX utility
make.</p>
<p>This code currently has four empirical potentials hardcoded into it, a
Lennard-Jones potential, the Silvera-Goldman potential
<span id="id1">[<a class="reference internal" href="bibliography.html#id1072"><span>SG78</span></a>]</span>, a 1D harmonic oscillator potential,
and the ideal gas (i.e. no potential interaction).</p>
<p>How the code is run is based on what command line arguments are passed
to it. The command line syntax is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">i</span><span class="o">-</span><span class="n">pi</span><span class="o">-</span><span class="n">driver</span> <span class="p">[</span><span class="o">-</span><span class="n">u</span><span class="p">]</span> <span class="o">-</span><span class="n">h</span> <span class="n">hostname</span> <span class="o">-</span><span class="n">p</span> <span class="n">port</span> <span class="o">-</span><span class="n">m</span> <span class="p">[</span><span class="n">gas</span><span class="o">|</span><span class="n">lj</span><span class="o">|</span><span class="n">sg</span><span class="o">|</span><span class="n">harm</span><span class="p">]</span> <span class="o">-</span><span class="n">o</span>
<span class="n">parameters</span> <span class="p">[</span><span class="o">-</span><span class="n">v</span><span class="p">]</span>
</pre></div>
</div>
<p>The flags do the following:</p>
<dl class="simple">
<dt>-u:</dt><dd><p>Optional parameter. If specified, the client will connect to a unix
domain socket. If not, it will connect to an internet socket.</p>
</dd>
<dt>-h:</dt><dd><p>Is followed in the command line argument list by the hostname of the
server.</p>
</dd>
<dt>-p:</dt><dd><p>Is followed in the command line argument list by the port number of
the server.</p>
</dd>
<dt>-m:</dt><dd><p>Is followed in the command line argument list by a string specifying
the type of potential to be used. “gas” gives no potential, “lj”
gives a Lennard-Jones potential, “sg” gives a Silvera-Goldman
potential and “harm” gives a 1D harmonic oscillator potential. Other
options should be clear from their description.</p>
</dd>
<dt>-o:</dt><dd><p>Is followed in the command line argument list by a string of comma
separated values needed to initialize the potential parameters. “gas”
requires no parameters, “harm” requires a spring constant, “sg”
requires a cut-off radius and “lj” requires the length and energy
scales and a cut-off radius to be specified. All of these must be
given in atomic units.</p>
</dd>
<dt>-v:</dt><dd><p>Optional parameter. If given, the client will print out more
information each time step.</p>
</dd>
</dl>
<p>This code should be fairly simple to extend to other pair-wise
interaction potentials, and examples of its use can be seen in the
“examples” directory, as explained in <a class="reference internal" href="#tests"><span class="std std-ref">Testing the install</span></a>.</p>
</section>
<section id="cp2k">
<h4>CP2K<a class="headerlink" href="#cp2k" title="Permalink to this heading">¶</a></h4>
<p>To use CP2K as the client code using an internet domain socket on the
host address “host_address” and on the port number “port” the following
lines must be added to its input file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">GLOBAL</span>
   <span class="o">...</span>
   <span class="n">RUN_TYPE</span> <span class="n">DRIVER</span>
   <span class="o">...</span>
<span class="o">&amp;</span><span class="n">END</span> <span class="n">GLOBAL</span>

<span class="o">&amp;</span><span class="n">MOTION</span>
   <span class="o">...</span>
   <span class="o">&amp;</span><span class="n">DRIVER</span>
      <span class="n">HOST</span> <span class="n">host_address</span>
      <span class="n">PORT</span> <span class="n">port</span>
   <span class="o">&amp;</span><span class="n">END</span> <span class="n">DRIVER</span>
   <span class="o">...</span>
<span class="o">&amp;</span><span class="n">END</span> <span class="n">MOTION</span>
</pre></div>
</div>
<p>If instead a unix domain socket is required then the following
modification is necessary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">MOTION</span>
   <span class="o">...</span>
   <span class="o">&amp;</span><span class="n">DRIVER</span>
      <span class="n">HOST</span> <span class="n">host_address</span>
      <span class="n">PORT</span> <span class="n">port</span>
      <span class="n">UNIX</span>
   <span class="o">&amp;</span><span class="n">END</span> <span class="n">DRIVER</span>
   <span class="o">...</span>
<span class="o">&amp;</span><span class="n">END</span> <span class="n">MOTION</span>
</pre></div>
</div>
<p>The rest of the input file should be the same as for a standard CP2K
calculation, as explained at <a class="reference external" href="www.cp2k.org/">www.cp2k.org/</a>.</p>
</section>
<section id="quantum-espresso">
<h4>Quantum-Espresso<a class="headerlink" href="#quantum-espresso" title="Permalink to this heading">¶</a></h4>
<p>To use Quantum-Espresso as the client code using an internet domain
socket on the host address “host_address” and on the port number “port”
the following lines must be added to its input file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;CONTROL
   ...
   calculation=`driver&#39;
   srvaddress=`host_address:port&#39;
   ...
/
</pre></div>
</div>
<p>If instead a unix domain socket is required then the following
modification is necessary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;CONTROL
   ...
   calculation=`driver&#39;
   srvaddress=`UNIX:socket_name:port&#39;
   ...
/
</pre></div>
</div>
<p>The rest of the input file should be the same as for a standard Quantum
Espresso calculation, as explained at
<a class="reference external" href="www.quantum-espresso.org/">www.quantum-espresso.org/</a>.</p>
</section>
<section id="lammps">
<h4>LAMMPS<a class="headerlink" href="#lammps" title="Permalink to this heading">¶</a></h4>
<p>To use LAMMPS as the client code using an internet domain socket on the
host address “host_address” and on the port number “port” the following
lines must be added to its input file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fix</span>  <span class="mi">1</span> <span class="nb">all</span> <span class="n">ipi</span> <span class="n">host_address</span> <span class="n">port</span>
</pre></div>
</div>
<p>If instead a unix domain socket is required then the following
modification is necessary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fix</span>  <span class="mi">1</span> <span class="nb">all</span> <span class="n">ipi</span> <span class="n">host_address</span> <span class="n">port</span> <span class="n">unix</span>
</pre></div>
</div>
<p>The rest of the input file should be the same as for a standard LAMMPS
calculation, as explained at <a class="reference external" href="http://lammps.sandia.gov/index.html">http://lammps.sandia.gov/index.html</a>. Note
that LAMMPS must be compiled with the <code class="docutils literal notranslate"><span class="pre">yes-user-misc</span></code> option to
communicate with i-PI. More information from
<a class="reference external" href="https://lammps.sandia.gov/doc/fix_ipi.html">https://lammps.sandia.gov/doc/fix_ipi.html</a>.</p>
</section>
<section id="fhi-aims">
<h4>FHI-aims<a class="headerlink" href="#fhi-aims" title="Permalink to this heading">¶</a></h4>
<p>To use FHI-aims as the client code using an internet domain socket on
the host address “host_address” and on the port number “port” the
following lines must be added to its <code class="docutils literal notranslate"><span class="pre">control.in</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">use_pimd_wrapper</span> <span class="n">host_address</span> <span class="n">port</span>
</pre></div>
</div>
<p>If instead a unix domain socket is required then the following
modification is necessary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">use_pimd_wrapper</span> <span class="n">UNIX</span><span class="p">:</span><span class="n">host_address</span> <span class="n">port</span>
</pre></div>
</div>
<p>One can also communicate different electronic-structure quantities to
i-PI through the <code class="docutils literal notranslate"><span class="pre">extra</span></code> string from FHI-aims. In this case the
following lines can be added to the <code class="docutils literal notranslate"><span class="pre">control.in</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">communicate_pimd_wrapper</span> <span class="n">option</span>
</pre></div>
</div>
<p>where option can be, e.g.,
<code class="docutils literal notranslate"><span class="pre">dipole,</span> <span class="pre">hirshfeld,</span> <span class="pre">workfunction,</span> <span class="pre">friction</span></code>.</p>
</section>
</section>
<section id="running-on-a-hpc-system">
<span id="hpc"></span><h3>Running on a HPC system<a class="headerlink" href="#running-on-a-hpc-system" title="Permalink to this heading">¶</a></h3>
<p>Running i-PI on a high-performance computing (HPC) system can be a bit
more challenging than running it locally using UNIX-domain sockets or
using the <em>localhost</em> network interface. The main problem is related to
the fact that different HPC systems adopt a variety of solutions to have
the different nodes communicate with each other and with the login
nodes, and to queue and manage computational jobs.</p>
<figure class="align-default" id="id2">
<span id="fig-running"></span><a class="reference internal image-reference" href="_images/ipi-running.svg"><img alt="_images/ipi-running.svg" src="_images/ipi-running.svg" width="90.0%" /></a>
<figcaption>
<p><span class="caption-text">Different approaches to run i-PI and a number of
instances of the forces code on a HPC system: a) running i-PI and the
clients in a single job; b) running i-PI and the clients on the same
system, but using different jobs, or running i-PI interactively on
the login node; c) running i-PI on a local workstation, communicating
with the clients (that can run on one or multiple HPC systems) over
the internet.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The figure represents schematically three different
approaches to run i-PI on a HPC system:</p>
<ol class="arabic">
<li><p>running both i-PI and multiple instances of the client as a single
job on the HPC system. The job submission script must launch i-PI
first, as a serial background job, then wait a few seconds for it to
load and create a socket</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python</span> <span class="n">i</span><span class="o">-</span><span class="n">pi</span> <span class="n">input_file</span><span class="o">.</span><span class="n">xml</span> <span class="o">&amp;&gt;</span> <span class="n">log</span> <span class="o">&amp;</span> <span class="n">wait</span> <span class="mi">10</span>
</pre></div>
</div>
</div></blockquote>
<p>Then, one should launch with mpirun or any system-specific mechanism
one or more independent instances of the client code. Note that not
all queing systems allow launching several mpirun instances from a
single job.</p>
</li>
<li><p>running i-PI and the clients on the HPC system, but in separate jobs.
Since i-PI consumes very little resources, one should ideally launch
it interactively on a login node</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">nohup</span> <span class="n">python</span> <span class="n">i</span><span class="o">-</span><span class="n">pi</span> <span class="n">input_file</span><span class="o">.</span><span class="n">xml</span> <span class="o">&lt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span> <span class="o">&amp;&gt;</span> <span class="n">log</span> <span class="o">&amp;</span>
</pre></div>
</div>
<p>or alternative on a queue with a very long wall-clock time. Then,
multiple instances of the client can be run as independent jobs: as
they start, they will connect to the server which will take care of
adding them dynamically to the list of active clients, dispatching
force calculations to them, and removing them from the list when
their wall-clock time expires. This is perhaps the model that applies
more easily to different HPC systems; however it requires having
permission to run on the head node, or having access to a long
wall-clock time queue that ensures that i-PI is always active.</p>
</li>
<li><p>running i-PI on a simple workstation, and performing communication
over the internet with the clients that run on one or more HPC
systems. This model exploits in full the distributed-computing model
that underlies the philosophy of i-PI and is very robust – as the
server can be always on, and the output of the simulation is
generated locally. However, this is also the most complicated to set
up, as the local workstation must accept in-coming connections from
the internet – which is not always possible when behind a firewall –
and the compute nodes of the HPC centre must have an outgoing
connection to the internet, which often requires ssh tunnelling
through a login node (see section <a class="reference internal" href="distributed.html#distrib"><span class="std std-ref">Distributed execution</span></a> for more
details).</p></li>
</ol>
</section>
</section>
<section id="testing-the-install">
<span id="tests"></span><h2>Testing the install<a class="headerlink" href="#testing-the-install" title="Permalink to this heading">¶</a></h2>
<section id="test-the-installation-with-nose">
<h3>test the installation with ‘nose‘<a class="headerlink" href="#test-the-installation-with-nose" title="Permalink to this heading">¶</a></h3>
<p>There are several test cases included, that can be run automatically
with ‘i-pi-tests‘ from the root directory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">i</span><span class="o">-</span><span class="n">pi</span><span class="o">-</span><span class="n">tests</span>
</pre></div>
</div>
</section>
<section id="test-cases-and-examples">
<h3>test cases and examples<a class="headerlink" href="#test-cases-and-examples" title="Permalink to this heading">¶</a></h3>
<p>The <cite>examples/</cite> folder contain a multitude of examples for i-PI, covering
most of the existing functionalities, and including also simple tests that
can be run with different client codes.</p>
<p>All the input files are contained in the directory “examples”, which is
subdivided into subfolder that cover different classes of simulations, and/or different client codes.</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="features.html" title="Core features"
              >previous</a> |
            <a href="units.html" title="Internal units and conventions"
              >next</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/getting-started.rst.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
    &#169; Copyright 2021, The i-PI developers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>